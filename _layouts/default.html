<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% if page.title %}{{ page.title }} · {% endif %}{{ site.title }}</title>
    {%- comment -%}Social previews (Open Graph + Twitter){%- endcomment -%}
    {%- assign _vtt_title = page.title | default: site.title -%}
    {%- assign _vtt_title_full = _vtt_title -%}
    {%- if page.title and site.title and page.title != site.title -%}
      {%- assign _vtt_title_full = page.title | append: ' · ' | append: site.title -%}
    {%- endif -%}

    {%- assign _vtt_desc = page.snippet | default: page.description -%}
    {%- if _vtt_desc and _vtt_desc != '' -%}
      {%- assign _vtt_desc = _vtt_desc | strip_html | strip_newlines | escape -%}
    {%- elsif page.excerpt and page.excerpt != '' -%}
      {%- assign _vtt_desc = page.excerpt | strip_html | strip_newlines | truncate: 200 | escape -%}
    {%- elsif site.description and site.description != '' -%}
      {%- assign _vtt_desc = site.description | strip_html | strip_newlines | escape -%}
    {%- else -%}
      {%- assign _vtt_desc = site.title | escape -%}
    {%- endif -%}

    {%- assign _vtt_url = page.url | absolute_url -%}

    {%- assign _vtt_img = page.image | default: page.og_image | default: site.social_image -%}
    {%- if _vtt_img and _vtt_img != '' -%}
      {%- assign _vtt_img_abs = _vtt_img | absolute_url -%}
    {%- else -%}
      {%- assign _vtt_img_abs = nil -%}
    {%- endif -%}

    {%- assign _vtt_type = 'website' -%}
    {%- if page.layout == 'post' -%}
      {%- assign _vtt_type = 'article' -%}
    {%- endif -%}

    <link rel="canonical" href="{{ _vtt_url }}" />
    <meta name="description" content="{{ _vtt_desc }}" />

    <meta property="og:site_name" content="{{ site.title | escape }}" />
    <meta property="og:type" content="{{ _vtt_type }}" />
    <meta property="og:title" content="{{ _vtt_title_full | escape }}" />
    <meta property="og:description" content="{{ _vtt_desc }}" />
    <meta property="og:url" content="{{ _vtt_url }}" />
    {%- if _vtt_img_abs -%}
    <meta property="og:image" content="{{ _vtt_img_abs }}" />
    {%- endif -%}

    <meta name="twitter:card" content="{% if _vtt_img_abs %}summary_large_image{% else %}summary{% endif %}" />
    <meta name="twitter:title" content="{{ _vtt_title_full | escape }}" />
    <meta name="twitter:description" content="{{ _vtt_desc }}" />
    {%- if _vtt_img_abs -%}
    <meta name="twitter:image" content="{{ _vtt_img_abs }}" />
    {%- endif -%}
    <link rel="stylesheet" href="{{ '/assets/css/site.css' | relative_url }}" />
    <link rel="icon" type="image/png" href="/assets/favicon/favicon.png">
  </head>
  <body class="{% if page.url == '/' %}is-home{% endif %}">
    <a class="skip" href="#content">Skip to content</a>

    <header class="masthead">
      <div class="mast-top">
        <div class="mast-left">
          <div class="mast-date">{{ site.time | date: '%A, %B %-d, %Y' }}</div>
          <div class="mast-sub">Today's Paper</div>
        </div>

        <div class="mast-logo" aria-label="{{ site.title }}">
          <a href="{{ '/' | relative_url }}" class="logo">{{ site.title }}</a>
        </div>

        <div class="mast-right">
          <div class="mast-events" id="mastEvents" aria-label="Upcoming events">
            <div class="mast-events-kicker">Upcoming</div>
            <div class="mast-events-title" data-me-title>Upcoming event</div>
            <div class="mast-events-when" data-me-when></div>
          </div>
        </div>
      </div>

      <nav class="nav" aria-label="Primary">
        <a href="{{ '/' | relative_url }}" class="nav-item">Home</a>

        <div class="nav-dd">
          <button class="nav-item nav-dd-btn" type="button" aria-haspopup="true">
            Categories <span class="nav-caret" aria-hidden="true">▾</span>
          </button>
          <div class="nav-dd-menu" role="menu" aria-label="Categories">
            <a role="menuitem" href="{{ '/category/' | relative_url }}">Browse</a>
            <div class="nav-dd-rule" aria-hidden="true"></div>

            <div class="nav-dd-head">Venues</div>
            <a role="menuitem" href="{{ '/category/' | relative_url }}?venue={{ 'Chicago' | url_encode }}"><span class="nav-dd-label">Chicago</span></a>
            <a role="menuitem" href="{{ '/category/' | relative_url }}?venue={{ 'New York' | url_encode }}"><span class="nav-dd-label">New York</span></a>
            <a role="menuitem" href="{{ '/category/' | relative_url }}?venue={{ 'Belur Math' | url_encode }}"><span class="nav-dd-label">Belur Math</span></a>

            <div class="nav-dd-rule" aria-hidden="true"></div>
            <div class="nav-dd-head">Speakers</div>
            <a role="menuitem" href="{{ '/category/' | relative_url }}?speaker={{ 'Swami Sarvapriyananda' | url_encode }}"><span class="nav-dd-label">Swami Sarvapriyananda</span></a>
            <a role="menuitem" href="{{ '/category/' | relative_url }}?speaker={{ 'Swami Ishatmananda' | url_encode }}"><span class="nav-dd-label">Swami Ishatmananda</span></a>
            <a role="menuitem" href="{{ '/category/' | relative_url }}?speaker={{ 'Swami Purnananda' | url_encode }}"><span class="nav-dd-label">Swami Purnananda</span></a>

            <div class="nav-dd-rule" aria-hidden="true"></div>
            <div class="nav-dd-head">Subjects</div>
            <a role="menuitem" href="{{ '/category/' | relative_url }}?subject={{ 'Sri Ramakrishna' | url_encode }}"><span class="nav-dd-label">Sri Ramakrishna</span></a>
            <a role="menuitem" href="{{ '/category/' | relative_url }}?subject={{ 'Swami Vivekananda' | url_encode }}"><span class="nav-dd-label">Swami Vivekananda</span></a>
            <a role="menuitem" href="{{ '/category/' | relative_url }}?subject={{ 'Maa Sarada' | url_encode }}"><span class="nav-dd-label">Maa Sarada</span></a>
            <a role="menuitem" href="{{ '/category/' | relative_url }}?subject={{ 'Kalpataru' | url_encode }}"><span class="nav-dd-label">Kalpataru</span></a>
            <a role="menuitem" href="{{ '/category/' | relative_url }}?subject={{ 'Kathamrita' | url_encode }}"><span class="nav-dd-label">Kathamrita</span></a>
            <a role="menuitem" href="{{ '/category/' | relative_url }}?subject={{ 'Durga Puja' | url_encode }}"><span class="nav-dd-label">Durga Puja</span></a>
            <a role="menuitem" href="{{ '/category/' | relative_url }}?subject={{ 'Kali Puja' | url_encode }}"><span class="nav-dd-label">Kali Puja</span></a>
            <a role="menuitem" href="{{ '/category/' | relative_url }}?subject={{ 'Yoga' | url_encode }}"><span class="nav-dd-label">Yoga</span></a>
            <a role="menuitem" href="{{ '/category/' | relative_url }}?subject={{ 'Maya' | url_encode }}"><span class="nav-dd-label">Maya</span></a>
            <a role="menuitem" href="{{ '/category/' | relative_url }}?subject={{ 'Meditation' | url_encode }}"><span class="nav-dd-label">Meditation</span></a>

            <div class="nav-dd-rule" aria-hidden="true"></div>
            <div class="nav-dd-head">Texts</div>
            <a role="menuitem" href="{{ '/category/' | relative_url }}?text={{ 'Kathamrita' | url_encode }}"><span class="nav-dd-label">Kathamrita</span></a>
            <a role="menuitem" href="{{ '/category/' | relative_url }}?text={{ 'Bhagavad Gita' | url_encode }}"><span class="nav-dd-label">Bhagavad Gita</span></a>
            <a role="menuitem" href="{{ '/category/' | relative_url }}?text={{ 'Uddhava Gita' | url_encode }}"><span class="nav-dd-label">Uddhava Gita</span></a>
            <a role="menuitem" href="{{ '/category/' | relative_url }}?text={{ 'Upanishads' | url_encode }}"><span class="nav-dd-label">Upanishads</span></a>

            <div class="nav-dd-rule" aria-hidden="true"></div>
            <div class="nav-dd-head">Format</div>
            <a role="menuitem" href="{{ '/category/' | relative_url }}?format={{ 'Talk' | url_encode }}"><span class="nav-dd-label">Talk</span></a>
            <a role="menuitem" href="{{ '/category/' | relative_url }}?format={{ 'Puja' | url_encode }}"><span class="nav-dd-label">Puja</span></a>

            <div class="nav-dd-rule" aria-hidden="true"></div>
            <div class="nav-dd-head">Years</div>
            {% assign years = site.posts | group_by_exp:"post","post.date | date: '%Y'" | sort: "name" %}
            {% for y in years reversed %}
              <a role="menuitem" href="{{ '/category/' | relative_url }}?year={{ y.name }}"><span class="nav-dd-label">{{ y.name }}</span></a>
            {% endfor %}
          </div>
        </div>

        <a href="/events" class="nav-item">Events</a>
        <a href="/donate" class="nav-item">Donate</a>

        <div class="nav-dd">
          <button class="nav-item nav-dd-btn" type="button" aria-haspopup="true">
            More <span class="nav-caret" aria-hidden="true">▾</span>
          </button>
          <div class="nav-dd-menu" role="menu" aria-label="More">
            <a role="menuitem" href="/about">About</a>
            <a role="menuitem" href="/contact">Submit a story</a>
            <a role="menuitem" href="/contact">Contact</a>
          </div>
        </div>
      </nav>

      <div class="mast-rules" aria-hidden="true"></div>
    </header>

    <main id="content" class="page">
      {{ content }}
    </main>

    <footer class="footer">
      <div class="footer-inner">
        <div class="footer-title">{{ site.title }}</div>
        <div class="footer-meta">© {{ site.time | date: '%Y' }}. All rights reserved.</div>
      </div>
    </footer>
    <script>
      window.VTT_HOME_YT_CHANNELS = {{ site.home_youtube_channels | default: nil | jsonify }};
      window.VTT_POSTS_INDEX_URL = "{{ '/assets/data/posts_index.json' | relative_url }}";

      // Home-only: Upcoming events ticker (edit this list to maintain your events)
      window.VTT_UPCOMING_EVENTS = [
        { title: 'Saraswati Puja', when: '14 Feb 8 PM IST', iso: '2026-02-14T20:00:00+05:30' },
        { title: 'Shivaratri', when: '26 Feb 7 PM IST', iso: '2026-02-26T19:00:00+05:30' },
        { title: 'Sri Ramakrishna Jayanti', when: '19 Feb 8 PM IST', iso: '2026-02-19T20:00:00+05:30' },
        { title: 'Ram Navami', when: '26 Mar 10 AM IST', iso: '2026-03-26T20:00:00+05:30' },
        { title: 'Buddha Purnima', when: '1 May 7 PM IST', iso: '2026-05-01T19:00:00+05:30' },
        { title: 'Ratha Yatra', when: '16 Jul 8 PM IST', iso: '2026-07-16T20:00:00+05:30' },
        { title: 'Guru Purnima', when: '29 Jul 8 PM IST', iso: '2026-07-29T20:00:00+05:30' },
        { title: 'Janmashtami', when: '4 Sep 7 PM IST', iso: '2026-09-04T19:00:00+05:30' },
        { title: 'Mahalaya', when: '10 Oct 8 PM IST', iso: '2026-10-10T20:00:00+05:30' },
        { title: 'Diwali', when: '8 Nov 8 PM IST', iso: '2026-11-08T20:00:00+05:30' },
        { title: 'Kali Puja', when: '8 Nov 7 PM IST', iso: '2026-11-08T19:00:00+05:30' },
        { title: 'Jagadhatri Puja', when: '19 Nov 8 PM IST', iso: '2026-11-19T20:00:00+05:30' }        
      ];
    </script>
    <script defer src="{{ '/assets/js/youtube_widget.js' | relative_url }}"></script>
    <script defer src="{{ '/assets/js/flickr_slideshow.js' | relative_url }}"></script>
    <script defer src="{{ '/assets/js/post_enhancements.js' | relative_url }}"></script>
    <script>
    (() => {
      const dds = Array.from(document.querySelectorAll('.nav-dd'));
      if (!dds.length) return;

      function closeAll(except){
        dds.forEach(dd => { if (dd !== except) dd.classList.remove('open'); });
      }

      dds.forEach(dd => {
        const btn = dd.querySelector('.nav-dd-btn');
        if (!btn) return;
        btn.addEventListener('click', (e) => {
          e.preventDefault();
          const willOpen = !dd.classList.contains('open');
          closeAll(dd);
          dd.classList.toggle('open', willOpen);
        });
      });

      document.addEventListener('click', (e) => {
        if (!dds.some(dd => dd.contains(e.target))) closeAll(null);
      });
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') closeAll(null);
      });
    })();
    </script>

    <script>
    (function(){
      var box = document.getElementById('mastEvents');
      if (!box) return;

      var titleEl = box.querySelector('[data-me-title]');
      var whenEl = box.querySelector('[data-me-when]');
      var data = Array.isArray(window.VTT_UPCOMING_EVENTS) ? window.VTT_UPCOMING_EVENTS : [];

      function parseIso(iso){
        try {
          var t = new Date(String(iso || '')).getTime();
          return isNaN(t) ? 0 : t;
        } catch (e) {
          return 0;
        }
      }

      function getUpcoming(){
        var now = Date.now();
        var up = data
          .map(function(e){
            return {
              title: String((e && e.title) || ''),
              when: String((e && e.when) || ''),
              iso: String((e && e.iso) || ''),
              _t: parseIso(e && e.iso)
            };
          })
          .filter(function(e){ return e._t && e._t > now; });

        up.sort(function(a,b){ return a._t - b._t; });
        return up;
      }

      var rot = [];
      var idx = 0;

      function setContent(e){
        if (!titleEl || !whenEl) return;
        titleEl.textContent = e && e.title ? e.title : 'No upcoming events';
        whenEl.textContent = e && e.when ? e.when : '';
      }

      function fadeTo(e){
        box.classList.add('me-fade');
        window.setTimeout(function(){
          setContent(e);
          box.classList.remove('me-fade');
        }, 240);
      }

      function refresh(){
        var next = getUpcoming().slice(0,6);
      
        if (!next.length) {
          rot = [];
          idx = 0;
          setContent(null);
          return;
        }
      
        // Keep current item if still present
        var curKey = (rot[idx] && rot[idx].iso) ? rot[idx].iso : null;
        rot = next;
      
        var keepIndex = -1;
        if (curKey) {
          for (var i=0; i<rot.length; i++){
            if (rot[i].iso === curKey) { keepIndex = i; break; }
          }
        }
        idx = (keepIndex >= 0) ? keepIndex : 0;
        setContent(rot[idx]);
      }

      refresh();

      window.setInterval(function(){
        rot = getUpcoming().slice(0,6);
        if (!rot.length) {
          idx = 0;
          fadeTo(null);
          return;
        }
        if (rot.length === 1) {
          idx = 0;
          fadeTo(rot[0]);
          return;
        }
        idx = (idx + 1) % rot.length;
        fadeTo(rot[idx]);
      }, 15000);

      // Re-evaluate the list periodically (in case an event just passed)
      window.setInterval(function(){
        refresh();
      }, 60000);
    })();

var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
(function(){
var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
s1.async=true;
s1.src='https://embed.tawk.to/696dc8060f26dd197d661aa6/1jfadan0q';
s1.charset='UTF-8';
s1.setAttribute('crossorigin','*');
s0.parentNode.insertBefore(s1,s0);
})();

    </script>

  </body>
</html>
