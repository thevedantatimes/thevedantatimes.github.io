<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% if page.title %}{{ page.title }} · {% endif %}{{ site.title }}</title>
    <link rel="stylesheet" href="{{ '/assets/css/site.css' | relative_url }}" />
  </head>
  <body class="{% if page.url == '/' %}is-home{% endif %}">
    <a class="skip" href="#content">Skip to content</a>

    <header class="masthead">
      <div class="mast-top">
        <div class="mast-left">
          <div class="mast-date">{{ site.time | date: '%A, %B %-d, %Y' }}</div>
          <div class="mast-sub">Today's Paper</div>
        </div>

        <div class="mast-logo" aria-label="{{ site.title }}">
          <a href="{{ '/' | relative_url }}" class="logo">{{ site.title }}</a>
        </div>

        <div class="mast-right">
          <div class="mast-market"><span class="muted">Market</span> <span class="pos">+0.6%</span> <span class="arrow">↑</span></div>
          <div class="mast-mini">Dow</div>
        </div>
      </div>

      <nav class="nav" aria-label="Primary">
        <a href="{{ '/' | relative_url }}" class="nav-item">Home</a>

        <div class="nav-dd">
          <button class="nav-item nav-dd-btn" type="button" aria-haspopup="true">
            Categories <span class="nav-caret" aria-hidden="true">▾</span>
          </button>
          <div class="nav-dd-menu" role="menu" aria-label="Categories">
            <a role="menuitem" href="{{ '/category/' | relative_url }}">All categories</a>
            <div class="nav-dd-rule" aria-hidden="true"></div>
            {% assign cats = site.categories | sort %}
            {% for c in cats %}
              {% assign name = c[0] %}
              <a role="menuitem" href="{{ '/category/' | relative_url }}?c={{ name | url_encode }}">{{ name }}</a>
            {% endfor %}
          </div>
        </div>

        <a href="{{ '/category/' | relative_url }}" class="nav-item">Browse</a>
        <a href="#ytWidget" class="nav-item">Videos</a>

        <div class="nav-dd">
          <button class="nav-item nav-dd-btn" type="button" aria-haspopup="true">
            More <span class="nav-caret" aria-hidden="true">▾</span>
          </button>
          <div class="nav-dd-menu" role="menu" aria-label="More">
            <a role="menuitem" href="#">About</a>
            <a role="menuitem" href="#">Submit a story</a>
            <a role="menuitem" href="#">Newsletter</a>
            <a role="menuitem" href="#">Contact</a>
          </div>
        </div>
      </nav>

      <div class="mast-rules" aria-hidden="true"></div>
    </header>

    <main id="content" class="page">
      {{ content }}
    </main>

    <footer class="footer">
      <div class="footer-inner">
        <div class="footer-title">{{ site.title }}</div>
        <div class="footer-meta">© {{ site.time | date: '%Y' }}. Built with Jekyll.</div>
      </div>
    </footer>
    <script defer src="{{ '/assets/js/youtube_widget.js' | relative_url }}"></script>
    <script>
    (() => {
      const dds = Array.from(document.querySelectorAll('.nav-dd'));
      if (!dds.length) return;

      function closeAll(except){
        dds.forEach(dd => { if (dd !== except) dd.classList.remove('open'); });
      }

      dds.forEach(dd => {
        const btn = dd.querySelector('.nav-dd-btn');
        if (!btn) return;
        btn.addEventListener('click', (e) => {
          e.preventDefault();
          const willOpen = !dd.classList.contains('open');
          closeAll(dd);
          dd.classList.toggle('open', willOpen);
        });
      });

      document.addEventListener('click', (e) => {
        if (!dds.some(dd => dd.contains(e.target))) closeAll(null);
      });
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') closeAll(null);
      });
    })();
    </script>

  </body>
</html>
